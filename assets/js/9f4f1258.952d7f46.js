"use strict";(self.webpackChunkdev_portal_docsite=self.webpackChunkdev_portal_docsite||[]).push([[80666],{15680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>m});var i=n(96540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},d="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),u=a,m=d["".concat(l,".").concat(u)]||d[u]||h[u]||o;return n?i.createElement(m,r(r({ref:t},p),{},{components:n})):i.createElement(m,r({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:a,r[1]=s;for(var c=2;c<o;c++)r[c]=n[c];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},31520:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var i=n(58168),a=(n(96540),n(15680));const o={title:"Overview",sidebar_label:"Overview",sidebar_position:1,slug:"/middleware/ics29-fee/overview"},r="Overview",s={unversionedId:"middleware/ics29-fee/overview",id:"version-v9.0.x/middleware/ics29-fee/overview",title:"Overview",description:"Learn about what the Fee Middleware module is, and how to build custom modules that utilize the Fee Middleware functionality",source:"@site/ibc-go_versioned_docs/version-v9.0.x/04-middleware/01-ics29-fee/01-overview.md",sourceDirName:"04-middleware/01-ics29-fee",slug:"/middleware/ics29-fee/overview",permalink:"/ibc-go/middleware/ics29-fee/overview",draft:!1,tags:[],version:"v9.0.x",sidebarPosition:1,frontMatter:{title:"Overview",sidebar_label:"Overview",sidebar_position:1,slug:"/middleware/ics29-fee/overview"},sidebar:"defaultSidebar",previous:{title:"Overview",permalink:"/ibc-go/ibc/light-clients/tendermint/overview"},next:{title:"Integration",permalink:"/ibc-go/middleware/ics29-fee/integration"}},l={},c=[{value:"What is the Fee Middleware module?",id:"what-is-the-fee-middleware-module",level:2},{value:"Concepts",id:"concepts",level:2},{value:"Known Limitations",id:"known-limitations",level:2}],p={toc:c},d="wrapper";function h(e){let{components:t,...n}=e;return(0,a.yg)(d,(0,i.A)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"overview"},"Overview"),(0,a.yg)("admonition",{title:"Synopsis",type:"note"},(0,a.yg)("p",{parentName:"admonition"},"Learn about what the Fee Middleware module is, and how to build custom modules that utilize the Fee Middleware functionality")),(0,a.yg)("h2",{id:"what-is-the-fee-middleware-module"},"What is the Fee Middleware module?"),(0,a.yg)("p",null,"IBC does not depend on relayer operators for transaction verification. However, the relayer infrastructure ensures liveness of the Interchain network \u2014 operators listen for packets sent through channels opened between chains, and perform the vital service of ferrying these packets (and proof of the transaction on the sending chain/receipt on the receiving chain) to the clients on each side of the channel."),(0,a.yg)("p",null,"Though relaying is permissionless and completely decentralized and accessible, it does come with operational costs. Running full nodes to query transaction proofs and paying for transaction fees associated with IBC packets are two of the primary cost burdens which have driven the overall discussion on ",(0,a.yg)("strong",{parentName:"p"},"a general, in-protocol incentivization mechanism for relayers"),"."),(0,a.yg)("p",null,"Initially, a ",(0,a.yg)("a",{parentName:"p",href:"https://github.com/cosmos/ibc/pull/577/files"},"simple proposal")," was created to incentivize relaying on ICS20 token transfers on the destination chain. However, the proposal was specific to ICS20 token transfers and would have to be reimplemented in this format on every other IBC application module."),(0,a.yg)("p",null,"After much discussion, the proposal was expanded to a ",(0,a.yg)("a",{parentName:"p",href:"https://github.com/cosmos/ibc/tree/master/spec/app/ics-029-fee-payment"},"general incentivisation design")," that can be adopted by any ICS application protocol as ",(0,a.yg)("a",{parentName:"p",href:"/ibc-go/ibc/middleware/develop"},"middleware"),"."),(0,a.yg)("h2",{id:"concepts"},"Concepts"),(0,a.yg)("p",null,"ICS29 fee payments in this middleware design are built on the assumption that sender chains are the source of incentives \u2014 the chain on which packets are incentivized is the chain that distributes fees to relayer operators. However, as part of the IBC packet flow, messages have to be submitted on both sender and destination chains. This introduces the requirement of a mapping of relayer operator's addresses on both chains."),(0,a.yg)("p",null,"To achieve the stated requirements, the ",(0,a.yg)("strong",{parentName:"p"},"fee middleware module has two main groups of functionality"),":"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},"Registering of relayer addresses associated with each party involved in relaying the packet on the source chain. This registration process can be automated on start up of relayer infrastructure and happens only once, not every packet flow."),(0,a.yg)("p",{parentName:"li"},"This is described in the ",(0,a.yg)("a",{parentName:"p",href:"/ibc-go/middleware/ics29-fee/fee-distribution"},"Fee distribution section"),".")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},"Escrowing fees by any party which will be paid out to each rightful party on completion of the packet lifecycle."),(0,a.yg)("p",{parentName:"li"},"This is described in the ",(0,a.yg)("a",{parentName:"p",href:"/ibc-go/middleware/ics29-fee/msgs"},"Fee messages section"),"."))),(0,a.yg)("p",null,"We complete the introduction by giving a list of definitions of relevant terminology."),(0,a.yg)("p",null,(0,a.yg)("inlineCode",{parentName:"p"},"Forward relayer"),": The relayer that submits the ",(0,a.yg)("inlineCode",{parentName:"p"},"MsgRecvPacket")," message for a given packet (on the destination chain)."),(0,a.yg)("p",null,(0,a.yg)("inlineCode",{parentName:"p"},"Reverse relayer"),": The relayer that submits the ",(0,a.yg)("inlineCode",{parentName:"p"},"MsgAcknowledgement")," message for a given packet (on the source chain)."),(0,a.yg)("p",null,(0,a.yg)("inlineCode",{parentName:"p"},"Timeout relayer"),": The relayer that submits the ",(0,a.yg)("inlineCode",{parentName:"p"},"MsgTimeout")," or ",(0,a.yg)("inlineCode",{parentName:"p"},"MsgTimeoutOnClose")," messages for a given packet (on the source chain)."),(0,a.yg)("p",null,(0,a.yg)("inlineCode",{parentName:"p"},"Payee"),": The account address on the source chain to be paid on completion of the packet lifecycle. The packet lifecycle on the source chain completes with the receipt of a ",(0,a.yg)("inlineCode",{parentName:"p"},"MsgTimeout"),"/",(0,a.yg)("inlineCode",{parentName:"p"},"MsgTimeoutOnClose")," or a ",(0,a.yg)("inlineCode",{parentName:"p"},"MsgAcknowledgement"),"."),(0,a.yg)("p",null,(0,a.yg)("inlineCode",{parentName:"p"},"Counterparty payee"),": The account address to be paid on completion of the packet lifecycle on the destination chain. The package lifecycle on the destination chain completes with a successful ",(0,a.yg)("inlineCode",{parentName:"p"},"MsgRecvPacket"),"."),(0,a.yg)("p",null,(0,a.yg)("inlineCode",{parentName:"p"},"Refund address"),": The address of the account paying for the incentivization of packet relaying. The account is refunded timeout fees upon successful acknowledgement. In the event of a packet timeout, both acknowledgement and receive fees are refunded."),(0,a.yg)("h2",{id:"known-limitations"},"Known Limitations"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"At the time of the release of the feature (ibc-go v4) fee payments middleware only supported incentivisation of new channels; however, with the release of channel upgradeability (ibc-go v8.1) it is possible to enable incentivisation of all existing channels."),(0,a.yg)("li",{parentName:"ul"},"Even though unlikely, there exists a DoS attack vector on a fee-enabled channel if 1) there exists a relayer software implementation that is incentivised to timeout packets if the timeout fee is greater than the sum of the fees to receive and acknowledge the packet, and 2) only this type of implementation is used by operators relaying on the channel. In this situation, an attacker could continuously incentivise the relayers to never deliver the packets by incrementing the timeout fee of the packets above the sum of the receive and acknowledge fees. However, this situation is unlikely to occur because 1) another relayer behaving honestly could relay the packets before they timeout, and 2) the attack would be costly because the attacker would need to incentivise the timeout fee of the packets with their own funds. Given the low impact and unlikelihood of the attack we have decided to accept this risk and not implement any mitigation mesaures.")))}h.isMDXComponent=!0}}]);